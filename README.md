# IUPD

**IUPD Demo Project**

## Table of Contents

- [Setup](#setup)
- [How to Run the Code](#how-to-run-the-code)
- [Repository Structure](#repository-structure)
- [Modules Overview](#modules-overview)
- [Server Setup](#server-setup)
- [TODO List](#todo-list)

## Setup

Before running the project, we need provide some essential configuration and authentication info:

1. **Adjust Volume Mapping**:  
   Update the volume mapping in `docker/docker-compose.yaml` under `services.iupd.volumes`.

2. **Contruct .env File**:  
   Upload .env file, which contains all authentication information, to `docker` folder, following env_template file.
   Assign a UUID in the `.env` file located at `docker/.env`.

## How to Run the Code

To run the project, run the following command at `docker` folder:

```bash
docker-compose --env-file .env up --build
```

May need to cleanup previous containers and rebuild the image

## Repostory Structure

```
├── internet_prober
├── data_parser
├── data_uploader
├── source_data
└── docker
```

## Modules Overview

Below is an overview of essential modules of this project:

### internet_prober

- **Description**: This moduler probes target IP prefixes.

### data_parser

- **Description**: This module processes the results generated by the probing tools and prepares them for analysis.
- **Sub-Modules**:
  - **yrp2text**: Convert raw Yarrp output to text format by grouping traceroute results by target IP address; we add additional field, by sorting hops based on this counter field, we can reconstruct the orginal order of packets in the raw output.
  - **txt2json**: Map IP addresses to ASN using prefix2as and map IP to prefix using longest prefix match (may be done at server); we group the results by ASN into JSON

### data_uploader

- **Description**: This module handles the posting of processed data to our storage. It handles multiple cases where posting is not successful.

### source_data

- **Description**: Contains datasets and input files required by the other modules.
- **Datasets**:
  - **pfx2AS Dataset**: Maps IP prefixes to Autonomous Systems (AS).
  - **Target IP List**: Provides the list of target IP addresses for the probing module (1M prefixes).

### docker

- **Description**: Contains docker-related configuration files.
- **Configuration files**:
  - **docker-compose.yaml**: Contains defination for Docker Compose.
  - **.env**: Contains sensitive info - authentication.

## TODO List:

1. write to stat table
2. remove cycle data after inserting into ES
